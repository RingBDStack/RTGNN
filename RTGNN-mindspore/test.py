import mindspore as ms
from mindspore import Tensor
ms.set_context(device_target='CPU', device_id=0)
edge_feats = Tensor([[[ 6.9397e-01, -4.9838e-01],
         [ 2.2018e-01, -9.7059e-02],
         [ 4.2426e-01,  1.8286e-01],
         [-2.3803e-01, -1.5511e-01],
         [ 2.3272e-01, -5.8978e-01],
         [-1.1155e-01,  1.4856e-01],
         [ 1.6353e-01, -2.1790e-01],
         [ 2.0652e-01,  3.8826e-03],
         [-2.2389e-01, -1.8531e-01],
         [-2.4762e-02, -2.8833e-02],
         [ 4.7130e-02, -6.4144e-02],
         [-1.9842e-01,  1.1421e-01],
         [ 7.0224e-02, -9.5744e-03],
         [ 2.4919e-01, -1.1826e-01],
         [-8.9967e-02,  6.0074e-02],
         [-4.5387e-02, -2.6898e-01],
         [ 1.2684e-01,  4.3931e-02],
         [-2.1134e-01, -7.0048e-02],
         [-6.2836e-02, -1.1453e-01],
         [-4.3113e-02,  1.0349e-02],
         [ 1.1670e-02, -2.9017e-02],
         [-6.8295e-02,  3.9310e-02],
         [ 9.6168e-04, -4.7372e-02],
         [-3.0319e-02,  4.7514e-02],
         [-1.1865e-01, -1.2872e-02],
         [-2.2863e-01, -1.6313e-01],
         [-8.4560e-02, -8.8399e-02],
         [-6.4854e-02, -9.9546e-02],
         [ 7.1834e-04,  9.2994e-02],
         [-4.2180e-02, -5.5607e-02],
         [-1.0302e-01, -5.9362e-02],
         [-1.4466e-01,  5.8771e-02],
         [-8.1234e-02, -5.6902e-02],
         [-3.2502e-02,  4.7129e-02],
         [-4.1984e-03, -1.5949e-02],
         [ 7.3226e-02,  2.0622e-02],
         [-4.4462e-02, -2.4608e-01],
         [-1.8710e-01, -1.2586e-01],
         [ 3.0990e-02, -1.3306e-01],
         [-1.3500e-01, -1.5538e-02],
         [ 5.0689e-02, -2.6800e-02],
         [ 5.0741e-02,  2.4546e-03],
         [-1.3694e-01, -2.4471e-01],
         [ 5.2708e-02, -1.9563e-01],
         [ 3.9188e-02, -4.8828e-02],
         [-7.3450e-02, -1.4043e-01],
         [-8.3052e-02, -5.4313e-02],
         [ 3.2526e-02,  2.0420e-02],
         [-1.2089e-01, -6.3573e-02],
         [-1.3872e-01,  7.8109e-04],
         [-1.3486e-01, -8.7475e-03],
         [-1.3693e-01, -5.6972e-02],
         [-1.5137e-01, -2.4325e-01],
         [-7.9654e-03, -1.9764e-01],
         [ 7.4301e-03,  1.5935e-02],
         [-1.1339e-01,  1.2957e-01],
         [-1.6379e-02, -1.3747e-01],
         [-6.7491e-02,  1.2705e-03],
         [-1.5595e-01,  1.4293e-02],
         [-6.8607e-02, -6.1639e-02],
         [ 7.3840e-02, -5.9819e-02],
         [-2.1738e-02, -5.8697e-02],
         [ 3.4242e-02, -6.5276e-02],
         [ 6.0308e-02, -5.7512e-02],
         [-5.8907e-02, -5.4876e-03],
         [-8.6262e-02, -7.1162e-02],
         [-9.4501e-02, -1.0265e-01],
         [-1.3021e-01, -8.6184e-02],
         [ 6.9541e-03, -6.4044e-02],
         [ 3.9127e-02, -2.2896e-01],
         [-9.0894e-02, -3.7882e-02],
         [-3.8260e-03, -4.5036e-02],
         [-4.0715e-02,  9.6511e-05],
         [-4.1676e-02, -1.0262e-01],
         [ 2.5967e-02, -3.7291e-02],
         [-8.3022e-03, -5.8617e-02],
         [ 2.0420e-02, -3.8339e-02],
         [-6.2584e-02, -8.9922e-02],
         [-8.4382e-02, -1.1688e-01],
         [-1.0333e-02, -1.8507e-01],
         [-4.8189e-02, -7.1954e-02],
         [-7.3125e-02, -8.9395e-02],
         [ 3.6255e-02, -1.9553e-01],
         [ 6.6355e-02, -2.8499e-02],
         [-9.5095e-02, -3.0505e-02],
         [-4.8733e-02, -7.0907e-02],
         [-2.1070e-02, -3.4846e-02],
         [-4.0048e-02, -7.7214e-02],
         [-9.6050e-03, -1.3134e-01],
         [-8.6719e-02, -9.3590e-03]],

        [[ 7.0612e-01, -3.1038e-01],
         [ 3.0121e-01, -1.7211e-01],
         [ 4.3253e-01,  1.6523e-01],
         [-2.3575e-01, -8.8389e-03],
         [ 2.6969e-01, -2.5534e-01],
         [ 1.5673e-02,  7.5966e-03],
         [ 1.7308e-01, -1.0195e-01],
         [ 3.0343e-01, -9.3630e-02],
         [-1.1887e-01, -1.8042e-01],
         [ 4.5939e-02, -1.4317e-01],
         [-6.2119e-03, -8.1076e-02],
         [-5.5167e-02, -2.1498e-02],
         [ 9.9955e-02, -1.5001e-02],
         [ 5.7580e-02,  5.0483e-02],
         [ 8.4735e-02,  6.3229e-02],
         [ 1.2474e-01, -2.5870e-01],
         [ 5.3130e-02, -1.2321e-01],
         [ 2.0764e-02, -6.0419e-04],
         [ 2.8765e-02, -5.5223e-02],
         [-1.8217e-02, -1.8630e-01],
         [ 2.0068e-02, -1.7407e-01],
         [ 3.8705e-02, -5.6495e-02],
         [-1.5138e-02, -1.0839e-01],
         [ 9.2317e-02, -5.0113e-02],
         [-1.1029e-01, -9.6959e-02],
         [-2.5308e-01, -1.5338e-01],
         [-2.4546e-02, -1.4485e-01],
         [-9.2634e-02, -3.1943e-02],
         [ 6.6025e-03,  1.2351e-01],
         [ 1.5147e-03,  2.0666e-02],
         [-6.8220e-02, -1.7361e-01],
         [ 2.3023e-02, -4.0371e-02],
         [-1.1119e-02, -2.0644e-01],
         [ 8.1981e-02,  1.9434e-02],
         [ 9.9719e-02,  6.5403e-02],
         [-9.4731e-02, -1.2071e-01],
         [-4.0419e-02, -8.5482e-02],
         [-3.5367e-02,  3.9799e-02],
         [ 1.3584e-02, -8.7766e-02],
         [-1.1689e-03, -9.0320e-02],
         [ 8.7551e-02, -1.0281e-02],
         [-2.0194e-02,  7.4558e-03],
         [-1.1561e-01, -1.0127e-01],
         [-1.1715e-01, -8.9158e-02],
         [-5.3343e-02, -1.0356e-01],
         [ 1.6047e-01, -3.8198e-02],
         [-4.6896e-02, -1.1825e-01],
         [ 6.9833e-03,  2.2471e-02],
         [-9.9959e-02, -3.3541e-02],
         [-8.5444e-02, -1.4375e-01],
         [-1.7809e-01, -1.0480e-01],
         [-6.1214e-02, -2.9039e-02],
         [-6.0898e-02, -1.7431e-01],
         [-2.6897e-03, -1.8026e-01],
         [-1.1554e-01, -6.2423e-02],
         [-7.2678e-02, -3.2299e-02],
         [-5.1770e-02, -1.0544e-01],
         [-6.8499e-02, -5.3982e-02],
         [-1.2637e-02, -5.2151e-02],
         [ 2.1845e-02, -7.0850e-02],
         [-8.7053e-02, -8.4707e-02],
         [-9.8932e-02, -1.0791e-01],
         [-1.6678e-01, -8.9058e-02],
         [ 2.0730e-02,  3.4749e-02],
         [ 1.8280e-02, -1.9560e-01],
         [-4.4962e-03, -3.1028e-02],
         [-8.2567e-02, -4.4704e-02],
         [-1.6341e-01, -7.9432e-02],
         [-1.0544e-01,  1.2393e-02],
         [-1.1930e-01, -7.0890e-02],
         [-3.4803e-04, -6.3808e-02],
         [ 8.5110e-02,  7.2588e-03],
         [-1.1838e-01, -1.2871e-02],
         [-4.5285e-02, -7.9641e-02],
         [ 1.1055e-01, -5.6213e-03],
         [-2.5224e-02, -7.5122e-02],
         [ 1.8443e-02, -2.9630e-02],
         [-1.5189e-01, -4.5855e-02],
         [-1.0076e-01, -1.7410e-01],
         [ 8.1506e-03, -3.7247e-02],
         [ 1.1321e-01,  1.1801e-02],
         [ 2.7394e-02, -2.1447e-03],
         [-1.2357e-01, -1.8170e-01],
         [-5.7721e-02, -4.1553e-02],
         [-1.3863e-01, -1.0749e-01],
         [-5.1021e-03, -1.2120e-01],
         [-3.3406e-02, -5.9947e-02],
         [-6.4792e-02, -6.0195e-02],
         [-1.1642e-02, -1.3512e-01],
         [-9.9584e-02, -9.4482e-02]],

        [[ 6.4508e-01, -4.2714e-01],
         [ 1.3103e-01, -1.8795e-01],
         [ 4.5218e-01,  2.0032e-01],
         [-3.3353e-01, -2.4989e-01],
         [ 2.0398e-01, -4.1686e-01],
         [-1.2360e-01,  1.1459e-01],
         [ 2.3133e-01,  6.9056e-03],
         [-3.3038e-02, -1.3862e-01],
         [-1.7008e-01,  4.8410e-03],
         [ 2.4071e-02, -1.2559e-01],
         [-9.9317e-02,  5.8748e-03],
         [ 1.4960e-01,  7.8128e-02],
         [ 2.2379e-01, -5.4256e-02],
         [ 1.8046e-01,  4.3189e-02],
         [-3.7480e-02,  3.6111e-02],
         [-1.7076e-01, -3.3371e-01],
         [ 1.3324e-01,  1.7026e-03],
         [-5.7671e-03, -1.1349e-01],
         [-8.0824e-02, -1.6953e-02],
         [ 4.5989e-02, -1.5129e-01],
         [ 6.2570e-02, -1.6094e-02],
         [-1.0854e-01,  1.0677e-02],
         [-1.8039e-02, -8.8058e-02],
         [-6.4902e-02, -5.2287e-02],
         [ 8.1653e-02,  2.9751e-02],
         [-3.7430e-02,  5.8318e-02],
         [-2.6209e-01, -1.1294e-01],
         [-6.9688e-03, -7.6590e-02],
         [ 4.7202e-02, -1.2940e-01],
         [-8.1460e-02, -6.0892e-02],
         [-1.0805e-01, -1.5555e-01],
         [-1.9801e-01, -1.0122e-01],
         [-1.1565e-01, -3.0953e-01],
         [-3.4090e-01,  4.6118e-02],
         [-1.0987e-01, -6.0972e-02],
         [ 3.3356e-03, -8.1843e-02],
         [ 4.4181e-02,  1.6960e-03],
         [-6.3876e-02, -1.3823e-01],
         [ 9.9266e-03, -8.1251e-02],
         [-4.5303e-02, -5.3334e-02],
         [ 3.5691e-02, -1.7966e-01],
         [ 8.9126e-02, -1.1181e-01],
         [ 9.7012e-02,  4.2034e-02],
         [-1.5231e-01, -1.0676e-01],
         [ 1.0364e-02,  1.2078e-01],
         [-9.3909e-03,  5.1429e-02],
         [-2.8809e-02, -1.2359e-01],
         [ 8.4155e-02,  4.3876e-02],
         [ 6.4346e-02, -2.0172e-01],
         [ 3.5935e-02,  2.1033e-02],
         [ 1.4339e-01,  4.2908e-02],
         [-1.2578e-01, -3.7422e-02],
         [-8.9557e-02,  6.8498e-02],
         [-1.4959e-01, -9.6449e-02],
         [-3.4108e-02, -1.3950e-01],
         [ 1.4862e-01,  2.3947e-02],
         [ 7.6339e-02, -2.4014e-03],
         [ 1.1410e-02, -5.5135e-02],
         [ 5.6055e-02, -2.5039e-02],
         [ 2.5523e-02, -5.4708e-02],
         [-7.9286e-02,  8.0924e-02],
         [ 1.1598e-01,  8.2406e-02],
         [-1.4703e-02, -8.3832e-02],
         [-3.3760e-02, -6.8543e-02],
         [ 7.9846e-03, -6.2806e-02],
         [ 3.9937e-02, -7.8876e-02],
         [-1.6206e-01, -2.3195e-02],
         [ 5.5537e-02, -1.0557e-02],
         [-5.0586e-02, -1.2064e-01],
         [-2.9898e-02, -1.3178e-01],
         [-2.0747e-01, -1.2485e-01],
         [ 7.7794e-02, -1.9952e-02],
         [-1.3918e-01, -1.8863e-01],
         [-9.0100e-02, -1.3372e-01],
         [-1.2907e-01, -3.7725e-02],
         [-5.5782e-02, -1.1629e-01],
         [ 1.4859e-02,  7.1527e-02],
         [-1.1137e-01, -6.3447e-02],
         [-1.9842e-01, -1.1351e-01],
         [-1.0894e-01, -1.1104e-01],
         [-5.2460e-02, -3.0762e-02],
         [-1.6844e-01, -1.8699e-01],
         [-6.7982e-02, -7.2559e-02],
         [-6.9372e-02,  1.2795e-03],
         [-1.1820e-01, -1.4334e-01],
         [-1.9025e-02, -7.8660e-02],
         [-2.4706e-02, -4.4828e-02],
         [-9.5442e-02, -3.7821e-02],
         [ 8.9949e-02, -4.4257e-02],
         [-7.2280e-02, -4.2498e-02]],

        [[ 7.7256e-01, -4.4831e-01],
         [ 4.4079e-01, -4.0906e-02],
         [ 3.4933e-01,  1.2809e-01],
         [-3.6787e-01, -1.4820e-01],
         [ 2.9046e-01, -5.0630e-01],
         [-6.4124e-02,  3.1355e-01],
         [-4.8165e-02, -1.6362e-01],
         [ 1.2414e-01,  5.1528e-02],
         [-1.2348e-01, -1.1993e-01],
         [ 1.2388e-01, -6.9218e-02],
         [-1.2804e-01, -1.3020e-02],
         [-3.1427e-02,  2.3200e-01],
         [-1.2928e-01, -2.2819e-01],
         [ 2.8216e-01, -1.6183e-01],
         [ 1.1098e-02,  5.6484e-02],
         [-5.1465e-02, -1.9704e-01],
         [ 1.7936e-01, -8.2274e-03],
         [-1.8543e-02, -9.2080e-02],
         [-9.9980e-02, -1.0427e-01],
         [-4.6119e-02, -7.2603e-02],
         [ 6.8813e-02, -6.1410e-02],
         [-9.6113e-02,  1.6866e-02],
         [ 1.5194e-01,  6.9668e-02],
         [-1.5373e-01, -3.1552e-02],
         [-1.8507e-01, -8.9207e-02],
         [-2.4903e-01, -2.6525e-02],
         [-1.2421e-01, -2.4977e-01],
         [-6.2171e-02, -2.5491e-02],
         [ 2.9384e-02, -3.9898e-03],
         [-1.5026e-01,  8.4041e-02],
         [ 1.5223e-01,  1.4408e-02],
         [-2.3598e-02,  5.0915e-02],
         [-4.5853e-02, -2.3353e-01],
         [-1.6907e-01, -2.6144e-02],
         [-8.0770e-02,  5.3666e-02],
         [ 2.3823e-02, -5.7638e-02],
         [-9.7988e-02, -1.9063e-01],
         [-1.1521e-01, -8.9223e-02],
         [-4.3517e-02, -7.9021e-02],
         [ 5.5917e-02, -1.1344e-01],
         [ 8.3842e-02, -8.5421e-02],
         [ 7.6041e-02, -1.6005e-01],
         [-3.1841e-02, -1.7485e-01],
         [-1.2969e-01,  2.5673e-03],
         [-7.2060e-02,  9.2042e-02],
         [-5.9727e-02, -1.6270e-01],
         [ 6.3084e-02, -8.1696e-02],
         [-1.4033e-02, -1.0643e-01],
         [-5.0413e-02,  1.9442e-02],
         [ 1.7540e-01, -5.1389e-02],
         [-2.9835e-02, -8.0702e-02],
         [-1.2079e-01,  8.5572e-02],
         [-5.7418e-02, -1.9180e-02],
         [-7.2129e-02,  4.6983e-02],
         [ 8.1580e-04, -8.7911e-02],
         [ 1.1956e-01, -6.5479e-02],
         [-1.4804e-01, -7.6922e-02],
         [-8.7223e-03, -1.7213e-01],
         [ 1.5781e-02, -2.1600e-02],
         [ 4.2382e-02, -3.2698e-02],
         [-1.9620e-02, -4.8034e-02],
         [ 6.3798e-03, -3.0143e-02],
         [ 6.2357e-02, -1.8351e-01],
         [ 4.1060e-02,  2.4311e-03],
         [ 2.6136e-02, -2.1121e-01],
         [-3.6291e-02, -1.6948e-01],
         [-7.1226e-02, -6.5893e-02],
         [ 4.6724e-02, -1.3936e-01],
         [ 1.4089e-02, -1.0445e-01],
         [-7.4357e-02, -1.7920e-01],
         [-5.3977e-02, -3.3018e-02],
         [ 1.3404e-01, -1.4098e-01],
         [-9.0199e-02, -5.4203e-02],
         [ 3.8550e-02,  1.3570e-01],
         [-5.4084e-02, -5.2232e-02],
         [-8.2985e-02, -9.6869e-02],
         [ 3.2497e-02,  4.8659e-02],
         [-1.0570e-01, -3.1139e-02],
         [-1.3066e-02, -2.0366e-01],
         [-3.0354e-02, -1.5680e-01],
         [ 9.2007e-03, -1.1616e-01],
         [ 1.8993e-02, -2.8898e-02],
         [-1.2866e-01, -1.2362e-01],
         [ 5.8966e-02,  4.2679e-02],
         [-1.2959e-01, -4.6323e-02],
         [-1.1850e-02, -7.1979e-02],
         [ 5.7781e-02, -1.4356e-01],
         [-1.2125e-02, -1.3461e-01],
         [ 1.3186e-02,  1.2537e-03],
         [-1.5954e-01, -8.6553e-02]]])

neighs_idx = Tensor([ 0,  1,  2,  3,  6, 10, 11, 12, 13, 16, 17, 18, 19, 20, 22, 28, 29, 30,
        31, 32, 33, 34, 35, 36, 37, 38, 40, 42, 45, 48, 50, 52, 54, 55, 56, 57,
        58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75,
        76, 77, 80, 84, 88])
a = Tensor([[ 0.7643,  0.9928],
        [-0.1396, -0.7780],
        [ 0.4179, -0.4779],
        [-0.2783,  0.2013],
        [ 0.2136,  0.1497],
        [ 0.2524, -0.0071],
        [ 0.0486, -0.0051],
        [ 0.1182, -0.0676],
        [ 0.1909, -0.2896],
        [ 0.1097, -0.0651],
        [ 0.0163, -0.0284],
        [ 0.2463, -0.2122],
        [ 0.0579, -0.2516],
        [-0.1104, -0.0674],
        [-0.1612, -0.0052],
        [ 0.1955, -0.0026],
        [ 0.1092,  0.1450],
        [ 0.1226, -0.0035],
        [ 0.0918, -0.2641],
        [-0.0483, -0.0604],
        [ 0.0571,  0.0789],
        [ 0.1455, -0.0362],
        [ 0.1127,  0.1340],
        [ 0.2722, -0.0979],
        [ 0.0231, -0.0969],
        [ 0.0931, -0.2491],
        [ 0.1998,  0.0433],
        [ 0.1121, -0.1609],
        [ 0.0698, -0.0963],
        [ 0.0067, -0.1125],
        [ 0.1550, -0.0663],
        [-0.0303,  0.0195],
        [ 0.1101, -0.1243],
        [ 0.0241, -0.1192],
        [ 0.1123, -0.0916],
        [ 0.0565, -0.3712],
        [ 0.0049, -0.1655],
        [ 0.2318,  0.0870],
        [ 0.0287, -0.1282],
        [ 0.0122, -0.0471],
        [ 0.0735, -0.0509],
        [-0.0197, -0.1144],
        [-0.1077, -0.1396],
        [ 0.0735, -0.1334],
        [ 0.0736, -0.0872],
        [-0.0186, -0.1556],
        [ 0.0685, -0.0253],
        [-0.0367, -0.1981],
        [-0.0283, -0.0804],
        [ 0.1113, -0.0023],
        [ 0.0308,  0.1313],
        [ 0.0129, -0.0714],
        [-0.0229, -0.1129]])
print(a.shape)
print(edge_feats.__class__)
print(edge_feats[0][neighs_idx])